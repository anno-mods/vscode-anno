{
	"name": "Anno ModOps XML",
	"scopeName": "text.xml.modops",
	"patterns": [
		{ "include": "#modopsElement" },
		{ "include": "#xmlTag" },
		{
			"begin": "(<!)(DOCTYPE)\\s+([:a-zA-Z_][:a-zA-Z0-9_.-]*)",
			"captures": {
				"1": {
					"name": "punctuation.definition.tag.xml"
				},
				"2": {
					"name": "keyword.other.doctype.xml"
				},
				"3": {
					"name": "variable.language.documentroot.xml"
				}
			},
			"end": "\\s*(>)",
			"name": "meta.tag.sgml.doctype.xml",
			"patterns": [
				{
					"include": "#internalSubset"
				}
			]
		},
		{ "include": "#comments" },
		{ "include": "#cdata" }
	],
	"repository": {
		"inlineModop": {
			"begin": "(</?)(ModOpContent|ModValueContent|ModValue|ModItem)",
			"captures": {
				"1": {
					"name": "punctuation.definition.tag.xml"
				},
				"2": {
					"name": "keyword.control"
				}
			},
			"end": "(/?>)",
			"name": "meta.tag.inlineModOp",
			"patterns": [
				{
					"include": "#attributes"
				}
			]
		},
		"xmlTag": {
			"begin": "(</?)(?:([-\\w\\.]+)((:)))?([-\\w\\.:]+)",
			"captures": {
				"1": {
					"name": "punctuation.definition.tag.xml"
				},
				"2": {
					"name": "entity.name.tag.namespace.xml"
				},
				"3": {
					"name": "entity.name.tag.xml"
				},
				"4": {
					"name": "punctuation.separator.namespace.xml"
				},
				"5": {
					"name": "entity.name.tag.localname.xml"
				}
			},
			"end": "(/?>)",
			"name": "meta.tag.xml",
			"patterns": [
				{
					"include": "#attributes"
				}
			]
		},
		"modopsElement": {
			"name": "meta.block.modops",
			"begin": "(<)(ModOps)(?=([\\s>/]))",
			"beginCaptures": {
				"1": { "name": "punctuation.definition.tag.xml" },
				"2": { "name": "keyword.control" },
				"3": { "name": "punctuation.definition.tag.xml" }
			},

			"end": "(</)(ModOps)(\\s*)(>)",
			"endCaptures": {
				"1": { "name": "punctuation.definition.tag.xml" },
				"2": { "name": "keyword.control" },
				"4": { "name": "punctuation.definition.tag.xml" }
			},
			"patterns": [
				{ "include": "#groupElement" },
				{ "include": "#modopElement" },
				{ "include": "#assetModopElement" },
				{ "include": "#modopElementSelfClosing" },
				{ "include": "#xmlTag" },
				{ "include": "#comments" }
			]
		},
		"groupElement": {
			"name": "meta.block.group",
			"begin": "(<)(?=Group([\\s>]))(?!Group[^>]*\\/>)",
			"beginCaptures": {
				"1": { "name": "punctuation.definition.tag.xml" },
				"2": { "name": "keyword.control" },
				"3": { "name": "punctuation.definition.tag.xml" }
			},
			"end": "(</)(Group)(\\s*)(>)",
			"endCaptures": {
				"1": { "name": "punctuation.definition.tag.xml" },
				"2": { "name": "keyword.control" },
				"4": { "name": "punctuation.definition.tag.xml" }
			},
			"patterns": [
				{
					"begin": "(Group)(?=([\\s>]))",
					"beginCaptures": {
						"1": { "name": "keyword.control" },
						"2": { "name": "punctuation.definition.tag.xml" }
					},
					"end": "(>)",
					"endCaptures": {
						"1": { "name": "punctuation.definition.tag.xml" }
					},
					"patterns": [
						{ "include": "#attributes" }
					]
				},
				{ "include": "#groupElement" },
				{ "include": "#modopElement" },
				{ "include": "#assetModopElement" },
				{ "include": "#modopElementSelfClosing" },
				{ "include": "#xmlTag" },
				{ "include": "#comments" }
			]
		},
		"modopElement": {
			"begin": "(<)(?=ModOp([\\s>]))(?!ModOp[^>]*\\/>)",
			"beginCaptures": {
				"1": { "name": "punctuation.definition.tag.xml" },
				"2": { "name": "punctuation.definition.tag.xml" }
			},
			"end": "(</)(ModOp)(\\s*)(>)",
			"endCaptures": {
				"1": { "name": "punctuation.definition.tag.xml" },
				"2": { "name": "keyword.control" },
				"4": { "name": "punctuation.definition.tag.xml" }
			},
			"name": "meta.keyword.modop",
			"patterns": [
				{
					"begin": "(ModOp)(?=([\\s>]))",
					"beginCaptures": {
						"1": { "name": "keyword.control" },
						"2": { "name": "punctuation.definition.tag.xml" }
					},
					"end": "(>)",
					"endCaptures": {
						"1": { "name": "punctuation.definition.tag.xml" }
					},
					"patterns": [
						{ "include": "#attributes" }
					]
				},
				{ "include": "#inlineModop" },
				{ "include": "#xmlTag" },
				{ "include": "#comments" }
			]
		},
		"modopElementSelfClosing": {
			"begin": "(<)(ModOp|Include|Group|Asset)(?=[\\s>][^/>]*/>)",
			"beginCaptures": {
				"1": { "name": "punctuation.definition.tag.xml" },
				"2": { "name": "keyword.control" },
				"3": { "name": "punctuation.definition.tag.xml" }
			},
			"end": "(\\s*)(/>)",
			"endCaptures": {
				"1": { "name": "punctuation.definition.tag.xml" },
				"2": { "name": "punctuation.definition.tag.xml" }
			},
			"name": "meta.keyword.modop",
			"patterns": [
				{ "include": "#attributes" }
			]
		},
		"assetModopElement": {
			"begin": "(<)(?=Asset([\\s>]))(?!Asset[^>]*\\/>)",
			"beginCaptures": {
				"1": { "name": "punctuation.definition.tag.xml" },
				"2": { "name": "keyword.control" },
				"3": { "name": "punctuation.definition.tag.xml" }
			},
			"end": "(</)(Asset)(\\s*)(>)",
			"endCaptures": {
				"1": { "name": "punctuation.definition.tag.xml" },
				"2": { "name": "keyword.control" },
				"4": { "name": "punctuation.definition.tag.xml" }
			},
			"name": "meta.keyword.modops",
			"patterns": [
				{
					"begin": "(Asset)(?=([\\s>]))",
					"beginCaptures": {
						"1": { "name": "keyword.control" },
						"2": { "name": "punctuation.definition.tag.xml" }
					},
					"end": "(>)",
					"endCaptures": {
						"1": { "name": "punctuation.definition.tag.xml" }
					},
					"patterns": [
						{ "include": "#attributes" }
					]
				},
				{ "include": "#inlineModop" },
				{ "include": "#xmlTag" },
				{ "include": "#comments" }
			]
		},
		"doublequotedString": {
			"begin": "\"",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.xml"
				}
			},
			"end": "\"",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.xml"
				}
			},
			"name": "string.quoted.double.xml"
		},
		"internalSubset": {
			"begin": "(\\[)",
			"captures": {
				"1": {
					"name": "punctuation.definition.constant.xml"
				}
			},
			"end": "(\\])",
			"name": "meta.internalsubset.xml",
			"patterns": [
				{
					"include": "#parameterEntity"
				},
				{
					"include": "#comments"
				}
			]
		},
		"parameterEntity": {
			"captures": {
				"1": {
					"name": "punctuation.definition.constant.xml"
				},
				"3": {
					"name": "punctuation.definition.constant.xml"
				}
			},
			"match": "(%)([:a-zA-Z_][:a-zA-Z0-9_.-]*)(;)",
			"name": "constant.character.parameter-entity.xml"
		},
		"singlequotedString": {
			"begin": "'",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.xml"
				}
			},
			"end": "'",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.xml"
				}
			},
			"name": "string.quoted.single.xml"
		},
		"attributes": {
			"patterns": [
				{
					"captures": {
						"1": {
							"name": "entity.other.attribute-name.namespace.xml"
						},
						"2": {
							"name": "entity.other.attribute-name.xml"
						},
						"3": {
							"name": "punctuation.separator.namespace.xml"
						},
						"4": {
							"name": "entity.other.attribute-name.localname.xml"
						}
					},
					"match": "(?:^|\\s+)(?:([-\\w.]+)((:)))?([-\\w.:]+)\\s*="
				},
				{
					"include": "#doublequotedString"
				},
				{
					"include": "#singlequotedString"
				}
			]
		},
		"comments": {
			"patterns": [
				{
					"begin": "<%--",
					"captures": {
						"0": {
							"name": "punctuation.definition.comment.xml"
						},
						"end": "--%>",
						"name": "comment.block.xml"
					}
				},
				{
					"begin": "<!--",
					"captures": {
						"0": {
							"name": "punctuation.definition.comment.xml"
						}
					},
					"end": "-->",
					"name": "comment.block.xml",
					"patterns": [
						{
							"begin": "--(?!>)",
							"captures": {
								"0": {
									"name": "invalid.illegal.bad-comments-or-CDATA.xml"
								}
							}
						}
					]
				}
			]
		},
		"cdata": {
			"begin": "<!\\[CDATA\\[",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin.xml"
				}
			},
			"end": "]]>",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end.xml"
				}
			},
			"name": "string.unquoted.cdata.xml"
		}
	}
}